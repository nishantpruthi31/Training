{"cells":[{"cell_type":"code","source":["%%capture\n","\n","!apt-get update\n","!apt-get install -y openjdk-8-jdk-headless -qq\n","!apt-get install maven -qq\n","\n","!curl -L \"https://archive.apache.org/dist/spark/spark-2.4.5/spark-2.4.5-bin-hadoop2.7.tgz\" > spark-2.4.5-bin-hadoop2.7.tgz\n","!tar -xvf spark-2.4.5-bin-hadoop2.7.tgz\n","!pip install -q findspark\n","!pip install pyspark py4j\n","from pyspark.sql import SparkSession\n","from pyspark.sql.functions import when\n","from pyspark.sql import functions\n","from pyspark.sql.types import IntegerType\n","from pyspark.sql.functions import col\n","#from pyspark.sql.Column import isNull\n","from pyspark.sql.functions import lit\n","spark = SparkSession.builder.master(\"local[*]\").config(\"spark.driver.memory\", \"16g\").getOrCreate()"],"metadata":{"id":"VgLhn5ATVIKk","executionInfo":{"status":"ok","timestamp":1703230132410,"user_tz":-330,"elapsed":111404,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}}},"execution_count":1,"outputs":[]},{"cell_type":"code","source":["# Flat Map is used as a maper of data and explodes data before final output\n","# It will create a new RDD\n","# rdd.flatMap(lambda x: x.split())\n","\n","# ['1 2 3' , '4 5 '6] what flatmap will do is ['1','2','3','4'..] i.e. a single list\n"],"metadata":{"id":"WrzX_u_eLz93","executionInfo":{"status":"ok","timestamp":1703230213763,"user_tz":-330,"elapsed":9,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}}},"execution_count":3,"outputs":[]},{"cell_type":"code","source":["\n","from pyspark import SparkConf, SparkContext\n","conf = SparkConf().setAppName(\"Read File\")\n","sc = SparkContext.getOrCreate(conf=conf)   # we provide configuration\n"],"metadata":{"id":"8zB0OqJqUhAR","executionInfo":{"status":"ok","timestamp":1703230209333,"user_tz":-330,"elapsed":517,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","source":["\n","rdd = sc.textFile('Sample.txt')\n","rdd.collect()\n"],"metadata":{"id":"mFSA-Hh8WznA","executionInfo":{"status":"ok","timestamp":1703230322906,"user_tz":-330,"elapsed":2954,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"a31c938b-8731-4793-f7d9-ab2bab7aae8f"},"execution_count":4,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['1 2 3 4 5', '3 4 5 66 77', '12 43 6 7 8', '12 12 33']"]},"metadata":{},"execution_count":4}]},{"cell_type":"code","source":["\n","rdd2=rdd.map(lambda x: x.split(' '))  # split by map\n","rdd2.collect()\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"AzJT8DnVXY23","executionInfo":{"status":"ok","timestamp":1703230357701,"user_tz":-330,"elapsed":3290,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"1caa146d-f6dd-4f3b-f568-a79335739827"},"execution_count":5,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[['1', '2', '3', '4', '5'],\n"," ['3', '4', '5', '66', '77'],\n"," ['12', '43', '6', '7', '8'],\n"," ['12', '12', '33']]"]},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["rdd3=rdd.flatMap(lambda x: x.split(' '))  # split by flatMap\n","rdd3.collect()\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Sqjj7dEEcjax","executionInfo":{"status":"ok","timestamp":1703230402273,"user_tz":-330,"elapsed":441,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"6ee3b45d-8d95-44ff-f8bf-6b14c6f4afd6"},"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['1',\n"," '2',\n"," '3',\n"," '4',\n"," '5',\n"," '3',\n"," '4',\n"," '5',\n"," '66',\n"," '77',\n"," '12',\n"," '43',\n"," '6',\n"," '7',\n"," '8',\n"," '12',\n"," '12',\n"," '33']"]},"metadata":{},"execution_count":6}]}],"metadata":{"colab":{"provenance":[{"file_id":"11YM-lleSvtN7VXzuep2XS63Vi7Wta6I6","timestamp":1703230426314},{"file_id":"1yaR5AnPIUKlGbxaBCFaqGOibqyzKSsaE","timestamp":1703061654276},{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1703060626608}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}