{"cells":[{"cell_type":"code","source":["%%capture\n","\n","!apt-get update\n","!apt-get install -y openjdk-8-jdk-headless -qq\n","!apt-get install maven -qq\n","\n","!curl -L \"https://archive.apache.org/dist/spark/spark-2.4.5/spark-2.4.5-bin-hadoop2.7.tgz\" > spark-2.4.5-bin-hadoop2.7.tgz\n","!tar -xvf spark-2.4.5-bin-hadoop2.7.tgz\n","!pip install -q findspark\n","!pip install pyspark py4j\n","from pyspark.sql import SparkSession\n","from pyspark.sql.functions import when\n","from pyspark.sql import functions\n","from pyspark.sql.types import IntegerType\n","from pyspark.sql.functions import col\n","#from pyspark.sql.Column import isNull\n","from pyspark.sql.functions import lit\n","spark = SparkSession.builder.master(\"local[*]\").config(\"spark.driver.memory\", \"16g\").getOrCreate()"],"metadata":{"id":"VgLhn5ATVIKk","executionInfo":{"status":"ok","timestamp":1704202875184,"user_tz":-330,"elapsed":114507,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}}},"execution_count":1,"outputs":[]},{"cell_type":"code","source":["\n","from pyspark import SparkConf, SparkContext\n","conf = SparkConf().setAppName(\"Read File\")\n","sc = SparkContext.getOrCreate(conf=conf)   # we provide configuration\n"],"metadata":{"id":"8zB0OqJqUhAR","executionInfo":{"status":"ok","timestamp":1704202885301,"user_tz":-330,"elapsed":708,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","source":["#1 No of students in the file\n","\n","rdd = sc.textFile('StudentData.csv')\n","#rdd.collect()\n","headers=rdd.first() # to get header row\n","rdd=rdd.filter(lambda x: x!= headers)\n","rdd.count()   # now header will be removed\n","rdd.collect()\n"],"metadata":{"id":"mFSA-Hh8WznA"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["\n","#2 total marks by male and female students\n","\n","rdd = sc.textFile('StudentData.csv')\n","headers=rdd.first() # to get header row\n","rdd=rdd.filter(lambda x: x!= headers)\n","rdd=rdd.map(lambda x:x.split(','))\n","rdd2=rdd\n","rdd2=rdd2.map(lambda x: (x[1],int(x[5])))\n","rdd2.reduceByKey(lambda x,y: x+y).collect()\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yxpigYFGgcUb","executionInfo":{"status":"ok","timestamp":1704203895214,"user_tz":-330,"elapsed":1655,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"e30ee0f2-172a-4295-ae4d-9dc5e2cd34b2"},"execution_count":17,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[('Female', 29636), ('Male', 30461)]"]},"metadata":{},"execution_count":17}]},{"cell_type":"code","source":["#3 pass and fail\n","\n","rdd3=rdd\n","passed=rdd3.filter(lambda x:int(x[5])>50).count()\n","failed=rdd3.filter(lambda x:int(x[5])<=50).count()\n","print(passed,failed)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oYdXLTxFWh_I","executionInfo":{"status":"ok","timestamp":1704203899901,"user_tz":-330,"elapsed":1186,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"e081ae59-86a9-418d-89ae-a19ae79e28d1"},"execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["630 370\n"]}]},{"cell_type":"code","source":["#4 total enrollment per course\n","\n","rdd4=rdd\n","rdd4=rdd4.map(lambda x:(x[3],1))\n","rdd4.reduceByKey(lambda x,y:x+y).collect()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pjwXCu-ZXiZh","executionInfo":{"status":"ok","timestamp":1704203906518,"user_tz":-330,"elapsed":1899,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"6c052aea-1df8-45e1-9312-2b80226631aa"},"execution_count":19,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[('DB', 157),\n"," ('Cloud', 192),\n"," ('PF', 166),\n"," ('MVC', 157),\n"," ('OOP', 152),\n"," ('DSA', 176)]"]},"metadata":{},"execution_count":19}]},{"cell_type":"code","source":["#5 Total marks per course\n","\n","rdd5=rdd\n","rdd5=rdd5.map(lambda x: (x[3], int(x[5])))\n","rdd5.reduceByKey(lambda x,y:x+y).collect()\n","\n"],"metadata":{"id":"cmu9GV4JYC58","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1704204051547,"user_tz":-330,"elapsed":4402,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"47b8eb5f-0ac1-4ba6-a413-963bc7301d7b"},"execution_count":21,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[('DB', 9270),\n"," ('Cloud', 11443),\n"," ('PF', 9933),\n"," ('MVC', 9585),\n"," ('OOP', 8916),\n"," ('DSA', 10950)]"]},"metadata":{},"execution_count":21}]},{"cell_type":"code","source":["#6 Average\n","rdd6=rdd\n","rdd6=rdd6.map(lambda x: (x[3], (int(x[5]),1)))\n","rdd6=rdd6.reduceByKey(lambda x,y:(x[0]+y[0],x[1]+y[1]))\n","#rdd6= rdd6.map(lambda x:(x[0],round(x[1][0]/x[1][1])))\n","#rdd6.collect()\n","\n","# alternate method\n","# i.e. remove this step rdd6= rdd6.map(lambda x:(x[0],round(x[1][0]/x[1][1])))\n","\n","rdd6.mapValues(lambda x:x[0]/x[1]).collect()\n","# we can use mapValues with reduceByKey also.\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3c-9dx1NbLSj","executionInfo":{"status":"ok","timestamp":1704204872722,"user_tz":-330,"elapsed":1849,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"0d05ce42-a688-425e-cc69-cacac9de2670"},"execution_count":32,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[('DB', 59.044585987261144),\n"," ('Cloud', 59.598958333333336),\n"," ('PF', 59.83734939759036),\n"," ('MVC', 61.05095541401274),\n"," ('OOP', 58.6578947368421),\n"," ('DSA', 62.21590909090909)]"]},"metadata":{},"execution_count":32}]},{"cell_type":"code","source":["#7 Maximum and minimum marks of course\n","rdd7=rdd\n","rdd7=rdd7.map(lambda x:(x[3],int(x[5])))\n","print(rdd7.reduceByKey(lambda x,y: x if x>y else y).collect())  # maximum marks\n","print(rdd7.reduceByKey(lambda x,y: x if x<y else y).collect())  # minimummm marks\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wqZFjZHYfW3k","executionInfo":{"status":"ok","timestamp":1704205164555,"user_tz":-330,"elapsed":2458,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"76e88dae-55ac-4252-a16b-1cb37551f72f"},"execution_count":34,"outputs":[{"output_type":"stream","name":"stdout","text":["[('DB', 98), ('Cloud', 99), ('PF', 99), ('MVC', 99), ('OOP', 99), ('DSA', 99)]\n","[('DB', 20), ('Cloud', 20), ('PF', 20), ('MVC', 22), ('OOP', 20), ('DSA', 20)]\n"]}]},{"cell_type":"code","source":["#8 Average age of male and female student\n","\n","rdd8=rdd\n","rdd8=rdd8.map(lambda x:( x[1], (int(x[0]),1)))\n","rdd8=rdd8.reduceByKey(lambda x,y: (x[0]+y[0] , x[1]+y[1]) )\n","\n","rdd8.mapValues(lambda x: round(x[0]/x[1])).collect()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"p2eLdDuhiRzT","executionInfo":{"status":"ok","timestamp":1704205747524,"user_tz":-330,"elapsed":1226,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"c9d104d6-a542-4b02-fc7b-7d61b6014808"},"execution_count":38,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[('Female', 28), ('Male', 29)]"]},"metadata":{},"execution_count":38}]}],"metadata":{"colab":{"provenance":[{"file_id":"11YM-lleSvtN7VXzuep2XS63Vi7Wta6I6","timestamp":1704205903621},{"file_id":"1yaR5AnPIUKlGbxaBCFaqGOibqyzKSsaE","timestamp":1703061654276},{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1703060626608}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}