{"cells":[{"cell_type":"code","source":["%%capture\n","\n","!apt-get update\n","!apt-get install -y openjdk-8-jdk-headless -qq\n","!apt-get install maven -qq\n","\n","!curl -L \"https://archive.apache.org/dist/spark/spark-2.4.5/spark-2.4.5-bin-hadoop2.7.tgz\" > spark-2.4.5-bin-hadoop2.7.tgz\n","!tar -xvf spark-2.4.5-bin-hadoop2.7.tgz\n","!pip install -q findspark\n","!pip install pyspark py4j\n","from pyspark.sql import SparkSession\n","from pyspark.sql.functions import when\n","from pyspark.sql import functions\n","from pyspark.sql.types import IntegerType\n","from pyspark.sql.functions import col\n","#from pyspark.sql.Column import isNull\n","from pyspark.sql.functions import lit\n","spark = SparkSession.builder.master(\"local[*]\").config(\"spark.driver.memory\", \"16g\").getOrCreate()"],"metadata":{"id":"VgLhn5ATVIKk","executionInfo":{"status":"ok","timestamp":1704271417662,"user_tz":-330,"elapsed":112772,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}}},"execution_count":1,"outputs":[]},{"cell_type":"code","source":["# from pyspark import SparkConf, SparkContext\n","# conf = SparkConf().setAppName(\"Read File\")\n","# sc = SparkContext.getOrCreate(conf=conf)\n","\n","# here we will create spark session for creating dataframe , spark Context won't work i.e.\n","\n","from pyspark.sql import SparkSession\n","spark=SparkSession.builder.appName(\"Spark Dataframes\").getOrCreate()\n","\n"],"metadata":{"id":"YV12JxkFfpQs","executionInfo":{"status":"ok","timestamp":1704271675961,"user_tz":-330,"elapsed":1829,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["\n","df=spark.read.option(\"header\",True).csv('StudentData.csv') # it means first row will be header\n","df.printSchema()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Vs1ZcBlcgZ5s","executionInfo":{"status":"ok","timestamp":1704272582125,"user_tz":-330,"elapsed":737,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"0fd9f128-2082-49d6-bbbd-9e93da6f9417"},"execution_count":10,"outputs":[{"output_type":"stream","name":"stdout","text":["root\n"," |-- age: string (nullable = true)\n"," |-- gender: string (nullable = true)\n"," |-- name: string (nullable = true)\n"," |-- course: string (nullable = true)\n"," |-- roll: string (nullable = true)\n"," |-- marks: string (nullable = true)\n"," |-- email: string (nullable = true)\n","\n"]}]},{"cell_type":"code","source":["#  to change schema we need to do a option\n","df=spark.read.option(\"inferSchema\",True).option(\"header\",True).csv('StudentData.csv') # it means first row will be header\n","df.printSchema()\n","# spark on it's own will decide schema\n","\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XsG3VwHXjq4x","executionInfo":{"status":"ok","timestamp":1704272663686,"user_tz":-330,"elapsed":970,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"1c65b178-0dee-492e-f322-26173759dbe1"},"execution_count":11,"outputs":[{"output_type":"stream","name":"stdout","text":["root\n"," |-- age: integer (nullable = true)\n"," |-- gender: string (nullable = true)\n"," |-- name: string (nullable = true)\n"," |-- course: string (nullable = true)\n"," |-- roll: integer (nullable = true)\n"," |-- marks: integer (nullable = true)\n"," |-- email: string (nullable = true)\n","\n"]}]},{"cell_type":"code","source":["\n","# instead of selecting multiple option we can do the following , i.e. options\n","df=spark.read.options(inferSchema=True,header=True,delimiter=\",\").csv('StudentData.csv') # it means first row will be header\n","df.printSchema()   # we can use delimiter option also in case delimiter is not coma"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"KkeVXP8JkQtS","executionInfo":{"status":"ok","timestamp":1704272964990,"user_tz":-330,"elapsed":707,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"e01fbec9-2a46-4f34-9ad2-0dcdabedd3ef"},"execution_count":13,"outputs":[{"output_type":"stream","name":"stdout","text":["root\n"," |-- age: integer (nullable = true)\n"," |-- gender: string (nullable = true)\n"," |-- name: string (nullable = true)\n"," |-- course: string (nullable = true)\n"," |-- roll: integer (nullable = true)\n"," |-- marks: integer (nullable = true)\n"," |-- email: string (nullable = true)\n","\n"]}]}],"metadata":{"colab":{"provenance":[{"file_id":"11YM-lleSvtN7VXzuep2XS63Vi7Wta6I6","timestamp":1704272989379},{"file_id":"1yaR5AnPIUKlGbxaBCFaqGOibqyzKSsaE","timestamp":1703061654276},{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1703060626608}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}