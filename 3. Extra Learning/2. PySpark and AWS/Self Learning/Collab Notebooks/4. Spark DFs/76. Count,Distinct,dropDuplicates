{"cells":[{"cell_type":"code","source":["%%capture\n","\n","!apt-get update\n","!apt-get install -y openjdk-8-jdk-headless -qq\n","!apt-get install maven -qq\n","\n","!curl -L \"https://archive.apache.org/dist/spark/spark-2.4.5/spark-2.4.5-bin-hadoop2.7.tgz\" > spark-2.4.5-bin-hadoop2.7.tgz\n","!tar -xvf spark-2.4.5-bin-hadoop2.7.tgz\n","!pip install -q findspark\n","!pip install pyspark py4j\n","from pyspark.sql import SparkSession\n","from pyspark.sql.functions import when\n","from pyspark.sql import functions\n","from pyspark.sql.types import IntegerType\n","from pyspark.sql.functions import col\n","#from pyspark.sql.Column import isNull\n","from pyspark.sql.functions import lit\n","spark = SparkSession.builder.master(\"local[*]\").config(\"spark.driver.memory\", \"16g\").getOrCreate()"],"metadata":{"id":"VgLhn5ATVIKk","executionInfo":{"status":"ok","timestamp":1704617263338,"user_tz":-330,"elapsed":123130,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}}},"execution_count":1,"outputs":[]},{"cell_type":"code","source":["\n","from pyspark.sql import SparkSession\n","from pyspark.sql.functions import col,lit\n","spark=SparkSession.builder.appName(\"Spark Dataframes\").getOrCreate()\n","\n"],"metadata":{"id":"YV12JxkFfpQs","executionInfo":{"status":"ok","timestamp":1704620485164,"user_tz":-330,"elapsed":4,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}}},"execution_count":34,"outputs":[]},{"cell_type":"code","source":["df=spark.read.options(header='True',inferSchema='True').csv('StudentData.csv')\n","df.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qgHaJLLDxDb0","executionInfo":{"status":"ok","timestamp":1704621894763,"user_tz":-330,"elapsed":900,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"e6b6c461-3b98-478b-ea21-4cf753d19169"},"execution_count":70,"outputs":[{"output_type":"stream","name":"stdout","text":["+---+------+----------------+------+------+-----+--------------------+\n","|age|gender|            name|course|  roll|marks|               email|\n","+---+------+----------------+------+------+-----+--------------------+\n","| 28|Female| Hubert Oliveras|    DB|  2984|   59|Annika Hoffman_Na...|\n","| 29|Female|Toshiko Hillyard| Cloud| 12899|   62|Margene Moores_Ma...|\n","| 28|  Male|  Celeste Lollis|    PF| 21267|   45|Jeannetta Golden_...|\n","| 29|Female|    Elenore Choy|    DB| 32877|   29|Billi Clore_Mitzi...|\n","| 28|  Male|  Sheryll Towler|   DSA| 41487|   41|Claude Panos_Judi...|\n","| 28|  Male|  Margene Moores|   MVC| 52771|   32|Toshiko Hillyard_...|\n","| 28|  Male|     Neda Briski|   OOP| 61973|   69|Alberta Freund_El...|\n","| 28|Female|    Claude Panos| Cloud| 72409|   85|Sheryll Towler_Al...|\n","| 28|  Male|  Celeste Lollis|   MVC| 81492|   64|Nicole Harwood_Cl...|\n","| 29|  Male|  Cordie Harnois|   OOP| 92882|   51|Judie Chipps_Clem...|\n","| 29|Female|       Kena Wild|   DSA|102285|   35|Dustin Feagins_Ma...|\n","| 29|  Male| Ernest Rossbach|    DB|111449|   53|Maybell Duguay_Ab...|\n","| 28|Female|  Latia Vanhoose|    DB|122502|   27|Latia Vanhoose_Mi...|\n","| 29|Female|  Latia Vanhoose|   MVC|132110|   55|Eda Neathery_Nico...|\n","| 29|  Male|     Neda Briski|    PF|141770|   42|Margene Moores_Mi...|\n","| 29|Female|  Latia Vanhoose|    DB|152159|   27|Claude Panos_Sant...|\n","| 29|  Male|  Loris Crossett|   MVC|161771|   36|Mitzi Seldon_Jenn...|\n","| 29|  Male|  Annika Hoffman|   OOP|171660|   22|Taryn Brownlee_Mi...|\n","| 29|  Male|   Santa Kerfien|    PF|182129|   56|Judie Chipps_Tary...|\n","| 28|Female|Mickey Cortright|    DB|192537|   62|Ernest Rossbach_M...|\n","+---+------+----------------+------+------+-----+--------------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"code","source":["df.count()   # displaying rows in df.\n","# df.filter(df.course==\"DB\").count()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"u_AkB2dTxpMy","executionInfo":{"status":"ok","timestamp":1704621898135,"user_tz":-330,"elapsed":683,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"15fccbc9-2140-42ed-a458-db90e1c2bf3b"},"execution_count":71,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1000"]},"metadata":{},"execution_count":71}]},{"cell_type":"code","source":["# distinct values\n","\n","# df.distinct().count()\n","\n","# df.select(\"gender\",\"age\").distinct().count()  # distinct count of gender and age\n","df.select(\"gender\",\"age\").distinct().show()  # it will only print gender and age\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Odib4CQD4Eot","executionInfo":{"status":"ok","timestamp":1704621902033,"user_tz":-330,"elapsed":747,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"6f301421-129f-402a-a5a4-c32655c34368"},"execution_count":72,"outputs":[{"output_type":"stream","name":"stdout","text":["+------+---+\n","|gender|age|\n","+------+---+\n","|Female| 29|\n","|Female| 28|\n","|  Male| 28|\n","|  Male| 29|\n","+------+---+\n","\n"]}]},{"cell_type":"code","source":["# apply distinct based on particular columns and get all values of other columns\n","\n","df.dropDuplicates([\"gender\",\"course\"]).show()  # only first occurence will be considered rest all duplicates considered\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GD5RHfErQJKj","executionInfo":{"status":"ok","timestamp":1704621906524,"user_tz":-330,"elapsed":679,"user":{"displayName":"Nishant Pruthi","userId":"05492412063404871418"}},"outputId":"b65c09f7-00d0-49b6-89da-a01e4a676621"},"execution_count":73,"outputs":[{"output_type":"stream","name":"stdout","text":["+---+------+----------------+------+------+-----+--------------------+\n","|age|gender|            name|course|  roll|marks|               email|\n","+---+------+----------------+------+------+-----+--------------------+\n","| 29|Female|Toshiko Hillyard| Cloud| 12899|   62|Margene Moores_Ma...|\n","| 28|Female| Hubert Oliveras|    DB|  2984|   59|Annika Hoffman_Na...|\n","| 29|Female|       Kena Wild|   DSA|102285|   35|Dustin Feagins_Ma...|\n","| 29|Female|  Latia Vanhoose|   MVC|132110|   55|Eda Neathery_Nico...|\n","| 28|Female|  Alberta Freund|   OOP|251805|   83|Annika Hoffman_Sh...|\n","| 29|Female|  Loris Crossett|    PF|201487|   96|Elenore Choy_Lati...|\n","| 29|  Male|     Billi Clore| Cloud|512047|   76|Taryn Brownlee_Ju...|\n","| 29|  Male| Ernest Rossbach|    DB|111449|   53|Maybell Duguay_Ab...|\n","| 28|  Male|  Sheryll Towler|   DSA| 41487|   41|Claude Panos_Judi...|\n","| 28|  Male|  Margene Moores|   MVC| 52771|   32|Toshiko Hillyard_...|\n","| 28|  Male|     Neda Briski|   OOP| 61973|   69|Alberta Freund_El...|\n","| 28|  Male|  Celeste Lollis|    PF| 21267|   45|Jeannetta Golden_...|\n","+---+------+----------------+------+------+-----+--------------------+\n","\n"]}]}],"metadata":{"colab":{"provenance":[{"file_id":"11YM-lleSvtN7VXzuep2XS63Vi7Wta6I6","timestamp":1704622825925},{"file_id":"1yaR5AnPIUKlGbxaBCFaqGOibqyzKSsaE","timestamp":1703061654276},{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1703060626608}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}